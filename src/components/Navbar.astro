---
// Archivo: src/components/Navbar.astro
const { pathname } = Astro.url;
// La funci칩n getPageName se encarga de que /about sea "/about", y / sea "/"
const getPageName = (path) => path.endsWith('/') && path.length > 1 ? path.slice(0, -1) : path;
---

<header>
    <nav class="navbar-apple">
        <ul class="nav-links">
            <!-- 1. HTML: A침adimos un elemento extra que ser치 la "p칤ldora" deslizante -->
            <li class="nav-pill-slider" aria-hidden="true"></li>

            <li><a href="/" class={getPageName(pathname) === "/" ? "active" : ""}>Inicio</a></li>
            <li><a href="/about" class={getPageName(pathname) === "/about" ? "active" : ""}>Sobre M칤</a></li>
            <li><a href="/colaboraciones" class={getPageName(pathname) === "/colaboraciones" ? "active" : ""}>Colaboraciones</a></li>
            <li><a href="/services" class={getPageName(pathname) === "/services" ? "active" : ""}>Servicios</a></li>
            <li><a href="/contact" class={getPageName(pathname) === "/contact" ? "active" : ""}>Contacto</a></li>
        </ul>
    </nav>
    <button class="theme-toggle-button" aria-label="Cambiar tema">游깿</button>
</header>

<style>
    /* Estilos del Header y Bot칩n (sin cambios) */
    header {
        position: sticky; top: 0; width: 100%; padding: 20px 0;
        display: flex; justify-content: center; position: relative; z-index: 1000;
    }
    .navbar-pill {
        display: flex; align-items: center;
        background-color: rgba(30, 30, 30, 0.75);
        backdrop-filter: blur(10px);
        padding: 12px 30px; border-radius: 50px; border: 1px solid #333;
    }
    .theme-toggle-button {
        position: absolute; top: 50%; right: 5%; transform: translateY(-50%);
        /* ... el resto de tus estilos para el bot칩n ... */
    }

    /* --- 2. CSS: Cambios para la animaci칩n --- */
    .nav-links {
        position: relative; /* Contenedor de referencia para la p칤ldora */
        list-style: none; display: flex; gap: 35px; margin: 0; padding: 0;
    }

    .nav-links a {
        position: relative; /* Hacemos que el texto est칠 por encima de la p칤ldora */
        z-index: 2;
        color: #a0a0a0; text-decoration: none; font-size: 16px; font-weight: 500;
        padding: 8px 12px; border-radius: 30px; transition: color 0.3s ease;
    }

    .nav-links a:hover,
    .nav-links a.active {
        color: var(--text-white);
    }
    
    /* 춰Quitamos el fondo est치tico del link activo! */
    .nav-links a.active {
        /* background-color: #333333; */ /* <--- Esta l칤nea se elimina o comenta */
    }

    /* Estilo de la p칤ldora deslizante */
    .nav-pill-slider {
        position: absolute;
        z-index: 1; /* Detr치s del texto de los links */
        top: -30%;
        left: 0;
        background-color: #333333;
        border-radius: 30px;
        transition: all 0.35s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Transici칩n suave con rebote */
    }
</style>

<!-- 3. JavaScript: La magia que mueve la p칤ldora -->
<script>
    // Seleccionamos los elementos que necesitamos del DOM
    const navLinksContainer = document.querySelector('.nav-links');
    const links = document.querySelectorAll('.nav-links a');
    const slider = document.querySelector('.nav-pill-slider');
    const activeLink = document.querySelector('.nav-links a.active');

    // Funci칩n que mueve la p칤ldora a la posici칩n de un link espec칤fico
    function moveSlider(target) {
        if (!target) return; // Si no hay link activo, no hagas nada
        
        const targetRect = target.getBoundingClientRect();
        const containerRect = navLinksContainer.getBoundingClientRect();
        
        // Calculamos la posici칩n del link relativo a su contenedor
        const left = targetRect.left - containerRect.left;
        
        slider.style.width = `${targetRect.width}px`;
        slider.style.height = `${targetRect.height}px`;
        slider.style.transform = `translateX(${left}px)`;
    }

    // Al cargar la p치gina, mueve la p칤ldora al link activo
    moveSlider(activeLink);

    // Para cada link, a침adimos un "escuchador" de eventos
    links.forEach(link => {
        // Cuando el mouse entra en un link, mueve la p칤ldora hacia 칠l
        link.addEventListener('mouseenter', () => moveSlider(link));
    });

    // Cuando el mouse sale del 치rea de la navegaci칩n...
    navLinksContainer.addEventListener('mouseleave', () => {
        // ...mueve la p칤ldora de vuelta al link que est치 activo
        moveSlider(activeLink);
    });
</script>